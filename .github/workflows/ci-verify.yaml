name: Verify Docker image(s)

defaults:
  run:
    shell: "bash -o errexit -o nounset -o pipefail {0}"

jobs:
  verify:
    runs-on: ubuntu-latest
    steps:
      - name: Check out repository
        uses: actions/checkout@v2
      - name: Build Docker image
        env:
          platform: ${{ matrix.platforms }}
        run: |
          cd ./${platform}/
          docker build --tag oscarotero/lume:latest-${platform} ./
    strategy:
      matrix:
        platforms:
          - alpine
          - debian
          - ubuntu

on:
  pull_request:
    branches:
      - main
